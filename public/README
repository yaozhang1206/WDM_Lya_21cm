This repository contains the codes and data used in the work "Unveiling the dark matter nature with reionization relics".

Code requirements: classy (which also requires cython)

[realization]: we have 4 realizations (r1-r4) and the average of them (ave).

[model]:
1) [DM]_[sigma8] with DM={3keV,4keV,6keV,9keV,cdm}, sigma8={s8(0.8159),sminus(0.7659),splus(0.8659)}, zeta=30.
2) zeta_[p#] with p#=p1-p8
p1=(cdm,sigma8=0.7659,zeta=20)
p2=(cdm,sigma8=0.7659,zeta=40)
p3=(cdm,sigma8=0.8659,zeta=20)
p4=(cdm,sigma8=0.8659,zeta=40)
p5=(3keV,sigma8=0.7659,zeta=20)
p6=(3keV,sigma8=0.7659,zeta=40)
p7=(3keV,sigma8=0.8659,zeta=20)
p8=(3keV,sigma8=0.8659,zeta=40)


######## data ########

- dNdzdg_QSO.dat
DESI quasar luminosity function

- sn-spec-lya-g[magnitude]-t4000.dat
DESI spectrograph performance

- skalow1_density_baseline.csv
reference: 
e.g.


######## 21cmFAST ########

- cross_21cm_[realization]_[model].txt
cross power spectrum (dimensionless, P(k)*k^3/(2*pi^2)) of matter and neutral hydrogen fraction (xHI) generated by 21cmFAST
e.g.
redshift k(Mpc^-1) dimensionless power spectrum
5.e+00 1.570796e-02 0.e+00
......

- matter_cross_21cm_[realization]_[model].txt
cross power spectrum of matter and xHI after implementing biasing procedure for large-scale mode
e.g.
redshift k(Mpc^-1) P(k)(Mpc^3)
5.000000e+00 1.000000e-03 0.000000e+00
......

- xH_21cm_[realization]_[model].txt
evolution of volume-weighted global neutral hydrogen fraction
e.g.
redshift xHI
3.537197473298937211e+01 9.997801780700683594e-01
......


######## gadget ########

- transp_gadget_[realization]_[model]_f.txt
column 1-7: psi(z_re,z_obs) in Equation (4), relative transparency of gas reionized at z_re compared to gas reionized at z=8 in CDM
column 8: radiation bias b_Gamma in Equation (2)
e.g.
          psi(z_re=6) psi(z_re=7) psi(z_re=8) psi(z_re=9) psi(z_re=10) psi(z_re=11) psi(z_re=12) b_Gamma
z_obs=2.0 0.01809 -0.00997 -0.01894 -0.02173 -0.02280 -0.02350 -0.02405 0.08886
z_obs=2.5 0.04902 0.01060 -0.00081 -0.00319 -0.00236 -0.00168 -0.00201 0.15411
          ......


######## pickles ########

- p_mpsi_[fast_realization]_[model]_[gadget_realization]_[model].pkl
pickle of the function P_m_psi(z_obs, k) where P_m_psi is the cross power spectrum of matter and psi (IGM transparency), Equation (1) for Lyman alpha forest

- p_mXi_[fast_realization]_[model]_[gadget_realization]_[model].pkl
pickle of the function P_m_Xi(z_obs, k) where P_m_Xi is the cross power spectrum of matter and Xi (HI density fluctuation), Equation (1) for 21 cm IM

- pat_[realization]_[model].pkl
pickle of the interpolator of P_m_xHI(z, k) where P_m_xHI is the cross power spectrum of matter and xHI in Equation (1)

- psi_[realization]_[model].pkl
pickle of the interpolator of psi(z_re,z_obs)

- rho_HI_func_[realization]_[model].pkl
pickle of the interpolator of rho_HI(z_re,z_obs) in Equation (9)


######## code ########

The usage of each .py file is at the beginning of the files.

In general,
- theory_P_lyas_arinyo.py
calculates the 3D lyman alpha forest power spectrum:
P_F^3D(z,k_Mpc,mu) = LyaLya_base_Mpc_norm(z, k_Mpc, mu) + LyaLya_reio_Mpc_norm(z, k_Mpc, mu), where LyaLya_base_Mpc_norm is the first term on the RHS of Equation (6) and LyaLya_reio_Mpc_norm is the second term on the RHS, which is the leading-order term of the impact of reionization on the 3D lyman alpha forest power spectrum.

- theory_P_21cm.py
calculates the 3D 21 cm IM power spectrum:
P3D_21_Mpc_norm(z, k_Mpc, mu) = HIHI_base_Mpc_norm(z, k_Mpc, mu) + HIHI_reio_Mpc_norm(z, k_Mpc, mu) where HIHI_base_Mpc_norm is the first term on the RHS of Equation (15) divided by Tb^2, i.e. (b_HI+mu^2*f)^2*P_m; HIHI_reio_Mpc_norm is the second term on the RHS divided by Tb^2, i.e. 2*(b_HI+mu^2*f)*P_mXi.

- mcmc_lya.py, mcmc_21cm.py, mcmc_combine.py: 2D mcmc results in Figure 3 (m_WDM,sigma8)

- mcmc3d_lya.py, mcmc3d_21cm.py, mcmc3d_combine.py: 3D mcmc results in Figure A6 (m_WDM,sigma8,zeta)

